   document.addEventListener('DOMContentLoaded', function () {
    var graphDiv = document.getElementById('graph');
    if (graphDiv) {
        var updateInterval = 1;

        var trace1 = {
            x: [],
            y: [],
            mode: 'lines',
            line: { color: 'red', width: 2 },
            name: 'График 1',
            type: 'scatter'
        };

        var trace2 = {
            x: [],
            y: [],
            mode: 'lines',
            line: { color: 'green', width: 2 },
            name: 'График 2',
            type: 'scatter'
        };

        var data = [trace1, trace2];

        var layout = {
            title: 'Осциллограф',
            xaxis: { title: 'Время' },
            yaxis: { title: 'Амплитуда' },
            plot_bgcolor: '#7aa5eb',
            paper_bgcolor: '#7aa5eb',
            showlegend: true,
            displayModeBar: true,
        };

        var config = {
            showLink: true,
            plotlyServerURL: "https://chart-studio.plotly.com",
            scrollZoom: true,
            displayModeBar: true,
        };

        Plotly.newPlot(graphDiv, data, layout, config);

        var currentIPAddress = 'http://192.168.64.7/data';
        var currentIPAddress2 = 'http://192.168.64.7/data2';

        function updateGraph() {
            Promise.all([
                fetch(currentIPAddress).then(response => response.json()),
                fetch(currentIPAddress2).then(response => response.json())
            ]).then(function(values) {
                var newData1 = values[0];
                var newData2 = values[1];

                trace1.x = newData1.map(point => point.time);
                trace1.y = newData1.map(point => point.amplitude);
                trace2.x = newData2.map(point => point.time);
                trace2.y = newData2.map(point => point.amplitude);

                // Обновление данных в массиве data
                data[0] = trace1;
                data[1] = trace2;

                Plotly.update(graphDiv, data, layout, config);
                setTimeout(updateGraph, updateInterval * 10); // Убедитесь, что updateInterval умножается на 1000, чтобы получить миллисекунды
            }).catch(error => console.error('Ошибка при обновлении графика:', error));
        }

        updateGraph();
    } else {
        console.log("Элемент с id='graph' не найден.");
    }
});


